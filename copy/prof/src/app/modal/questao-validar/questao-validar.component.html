<div *ngIf="isLoading" class="overlay d-flex justify-content-center align-items-center">
  <i class="fas fa-2x fa-sync fa-spin"></i>
</div>
<div class="modal-header">
  <a class="btn" *ngIf="vincular.isVinculando && questao && vincular.CanIShowActionButton(questao)"
    [ngClass]="{ 'btn-primary': !vincular.hasAdd(questao), 'btn-danger': vincular.hasAdd(questao) }"
    (click)="vincular.addQuestao(questao)">
    <i class="fas" [ngClass]="{ 'fa-plus': !vincular.hasAdd(questao), 'fa-times': vincular.hasAdd(questao) }"></i>
    {{ vincular.hasAdd(questao) ? 'Remover da Avaliação' : 'Adicionar à Avaliação' }}
  </a>
  <button type="button" class="close pull-right" aria-label="Close" (click)="close()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <app-questao-view [questao]="questao" [tipo]="nmQuestaoTipo" [alternativas]="alternativas" readOnly="true">
  </app-questao-view>
  <div id="validar" class="row" *ngIf="tramitar">
    <hr>
    <div class="col-3">
      <label class="col-form-label" for="cdQuestaoStatus">Status</label>
      <ng-select [(ngModel)]="cdQuestaoStatus" [items]="status" bindValue="cdQuestaoStatus" bindLabel="dsQuestaoStatus">
      </ng-select>
    </div>
    <div class="col-9">
      <label class="col-form-label" for="dissertacao">Dissertação</label>
      <textarea type="text" id="texto" rows="1" #txtarea [style.height]="(txtarea.scrollHeight)+'px'" class="form-control"
        name="text" [(ngModel)]="dissertacao" placeholder="Digite a dissertação aqui"></textarea>
    </div>
    <div class="col-12 text-center">
      <button type="submit" (click)="alterar()" class="btn btn-primary mt-3"
        [disabled]="!cdQuestaoStatus">Alterar</button>
    </div>
    <hr>
  </div>
  <div id="historico">
    <div class="row">
      <div class="col-12 table-responsive" *ngIf="tramitacoes.length > 0">
        <table class="table table-striped table-bordered table-sm row-border hover" datatable [dtOptions]="dtOptions">
          <thead>
            <tr>
              <th style="width: 24%;">Status</th>
              <th style="width: 22%;">Usuário</th>
              <th>Dissertação</th>
              <th style="width: 16%;">Data</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let q of tramitacoes; let i = index">
              <td>
                {{ q.dsQuestaoStatus | capitalizar }}
              </td>
              <td>
                {{ q.nmProfessor | capitalizar }}
              </td>
              <td>
                {{ q.dissertacao | capitalizar }}
              </td>
              <td>
                {{ q.dtIncReg | date:'dd/MM/yyyy HH:mm:SS' }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>